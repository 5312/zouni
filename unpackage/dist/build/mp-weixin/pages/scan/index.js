(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/scan/index"],{2389:function(o,t,n){"use strict";(function(o){n("29e1");e(n("66fd"));var t=e(n("a4da"));function e(o){return o&&o.__esModule?o:{default:o}}o(t.default)}).call(this,n("543d")["createPage"])},"3e62":function(o,t,n){"use strict";var e=n("4066"),i=n.n(e);i.a},4066:function(o,t,n){},6690:function(o,t,n){"use strict";(function(o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=function(){n.e("components/base/auth-login").then(function(){return resolve(n("ea72"))}.bind(null,n)).catch(n.oe)},i={components:{AuthLogin:e},data:function(){return{isLogin:!1,isShowAuthLogin:!1,siteId:null,detail:null,carCard:"",price:0,couponList:[],couponInfoPrice:{couponId:0,price:0,name:""}}},onLoad:function(o){console.log("参数",o);var t=o.q?decodeURIComponent(o.q):null,n=o.fromPage;if(t){var e=t.split("?")[1];if(e&&e.length>0){var i=e.split("=");i&&i.length>0&&"siteId"==i[0]&&(this.siteId=i[1],this.init())}}else"addCar"!==n&&"home"!==n||!o.siteId?"select"===n&&o.siteId&&(this.siteId=o.siteId,this.couponInfoPrice.couponId=o.userCouponId,this.init()):(this.siteId=o.siteId,this.init())},methods:{init:function(){var o=this;this.$tool.isGetLocation("scope.userInfo",(function(){o.logged()}),(function(){o.isLogin=!1,o.isShowAuthLogin=!0}))},loginOk:function(){this.logged()},selectCupon:function(){var o="/pages/scan/select?list=".concat(JSON.stringify(this.couponList),"&userCouponId=").concat(this.couponInfoPrice.couponId,"&siteId=").concat(this.siteId);this.$tool.uniNavigateTo({url:o})},logged:function(){var o=this,t=this;this.$tool.uniRequest({url:"/api/order/buyNow",params:{goods_id:this.siteId,coupon_id:this.couponInfoPrice.couponId,goods_sku_id:"0"},success:function(n){console.log("res",n),n.exist_car?(t.detail=n.goods_list[0],t.couponList=n&&n.coupon_list?n.coupon_list:[],t.carCard=n.car?n.car:"",t.price=n.order_pay_price,t.couponInfoPrice.price=n.coupon_money,t.isLogin=!0,t.isShowAuthLogin=!1):t.$tool.uniRedirectTo({url:"/pages/base/add-car?siteId=".concat(o.siteId,"&pageForm=scan&status=add")})}})},pay:function(){var t=this,n={wxapp_id:"10001",goods_id:this.siteId,coupon_id:this.couponInfoPrice.couponId,pay_type:"20"};console.log("支付参数",n),this.$tool.uniRequest({url:"/api/order/buyNow",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},params:n,success:function(n){if("20"===n.pay_type){var e=n.payment;t.$tool.wxPayMoney(e.timeStamp,e.nonceStr,e.prepay_id,"MD5",e.paySign,(function(e){t.$tool.uniShowToast({title:"支付成功！"}),setTimeout((function(){o.reLaunch({url:"/pages/scan/order-detail?id=".concat(n.order_id)})}),1e3)}))}else"30"===n.pay_type&&(t.$tool.uniShowToast({title:"支付成功！"}),setTimeout((function(){o.reLaunch({url:"/pages/scan/order-detail?id=".concat(n.order_id)})}),1e3))}})}}};t.default=i}).call(this,n("543d")["default"])},"9e68":function(o,t,n){"use strict";var e,i=function(){var o=this,t=o.$createElement;o._self._c},c=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return e}))},a4da:function(o,t,n){"use strict";n.r(t);var e=n("9e68"),i=n("e574");for(var c in i)"default"!==c&&function(o){n.d(t,o,(function(){return i[o]}))}(c);n("3e62");var s,u=n("f0c5"),a=Object(u["a"])(i["default"],e["b"],e["c"],!1,null,"2a77a88e",null,!1,e["a"],s);t["default"]=a.exports},e574:function(o,t,n){"use strict";n.r(t);var e=n("6690"),i=n.n(e);for(var c in e)"default"!==c&&function(o){n.d(t,o,(function(){return e[o]}))}(c);t["default"]=i.a}},[["2389","common/runtime","common/vendor"]]]);