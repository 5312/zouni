(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/scan/index"],{"22d6":function(t,n,e){"use strict";e.r(n);var o=e("c21c"),i=e.n(o);for(var u in o)"default"!==u&&function(t){e.d(n,t,(function(){return o[t]}))}(u);n["default"]=i.a},"43bd":function(t,n,e){"use strict";e.r(n);var o=e("6d24"),i=e.n(o);for(var u in o)"default"!==u&&function(t){e.d(n,t,(function(){return o[t]}))}(u);n["default"]=i.a},6651:function(t,n,e){"use strict";e.r(n);var o=e("6b78"),i=e("43bd");for(var u in i)"default"!==u&&function(t){e.d(n,t,(function(){return i[t]}))}(u);e("8476");var r,c=e("f0c5"),a=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"e1bb10f4",null,!1,o["a"],r);n["default"]=a.exports},"6b78":function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return u})),e.d(n,"a",(function(){return o}));var o={uSteps:function(){return e.e("uview-ui/components/u-steps/u-steps").then(e.bind(null,"afb2"))},uGrid:function(){return e.e("uview-ui/components/u-grid/u-grid").then(e.bind(null,"5a4d"))},uGridItem:function(){return e.e("uview-ui/components/u-grid-item/u-grid-item").then(e.bind(null,"aa84"))},uModal:function(){return e.e("uview-ui/components/u-modal/u-modal").then(e.bind(null,"d0a6"))},uRadioGroup:function(){return Promise.all([e.e("common/vendor"),e.e("uview-ui/components/u-radio-group/u-radio-group")]).then(e.bind(null,"545c"))},uRadio:function(){return e.e("uview-ui/components/u-radio/u-radio").then(e.bind(null,"6471"))},uButton:function(){return e.e("uview-ui/components/u-button/u-button").then(e.bind(null,"3e35"))}},i=function(){var t=this,n=t.$createElement;t._self._c},u=[]},"6d24":function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=u(e("92af")),i=u(e("b946"));function u(t){return t&&t.__esModule?t:{default:t}}function r(t,n){return l(t)||d(t,n)||a(t,n)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,n){if(t){if("string"===typeof t)return s(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?s(t,n):void 0}}function s(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}function d(t,n){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var e=[],o=!0,i=!1,u=void 0;try{for(var r,c=t[Symbol.iterator]();!(o=(r=c.next()).done);o=!0)if(e.push(r.value),n&&e.length===n)break}catch(a){i=!0,u=a}finally{try{o||null==c["return"]||c["return"]()}finally{if(i)throw u}}return e}}function l(t){if(Array.isArray(t))return t}var f=function(){e.e("components/base/auth-login").then(function(){return resolve(e("055c"))}.bind(null,e)).catch(e.oe)},p={components:{AuthLogin:f,Urgent:o.default},data:function(){return{src:"../../static/audio.mp3",zhanId:0,loading:!0,audioCtx:null,index:0,isLogin:!1,isShowAuthLogin:!1,siteId:null,detail:null,carCard:"",price:0,couponList:[],air:!1,value:"",current:0,numList:[{name:""},{name:""},{name:""}],couponInfoPrice:{couponId:0,price:0,name:""},winHeight:null,toView:""}},onLoad:function(t){var n=t.q?decodeURIComponent(t.q):null,e=t.fromPage;if(console.log(t),n){var o=n.split("?")[1];if(o&&o.length>0){var i=o.split("=");i&&i.length>0&&"siteId"==i[0]&&(this.siteId=i[1],this.init())}}else"addCar"!==e&&"home"!==e||!t.siteId?"select"===e&&t.siteId&&(this.siteId=t.siteId,this.couponInfoPrice.couponId=t.userCouponId,this.current=t.curr||0,this.init()):(this.siteId=t.siteId,this.init());var u=this;wx.getSystemInfo({success:function(t){u.winHeight=t.windowHeight-90*t.windowWidth/750+"px"}})},computed:{mess:function(){if(this.couponList.length<=0)return"你有".concat(this.couponList.length,"张优惠券可使用");for(var t,n=this.couponInfoPrice.couponId,e=0;e<this.couponList.length;e++){var o=this.couponList[e];o.user_coupon_id==n&&(t=o)}var i="次卡"==t.coupon_type.text?"免费洗车":t.name;return i},detail1:function(){return 0==this.current?"确认车辆是否停到指定位置":1==this.current?"确认完成以下操作":2==this.current?"确认订单信息":void 0},detail2:function(){return 0==this.current?"通过洗车两侧辅助镜查看":1==this.current?"确保洗车过程中车辆安全":2==this.current?"":void 0}},watch:{value:function(t){}},methods:{hasActive:function(t){this.$tool.uniShowToast({icon:"none",title:"暂不支持！"})},rich:function(){this.$tool.uniNavigateTo({url:"/pages/base/rich?fromPage=serviceAgreement"})},init:function(){var t=this;this.$tool.isGetLocation("scope.userInfo",(function(){t.logged()}),(function(){t.isLogin=!1,t.isShowAuthLogin=!0}))},loginOk:function(){this.logged()},selectCupon:function(){var t="/pages/scan/select?list=".concat(JSON.stringify(this.couponList),"&userCouponId=").concat(this.couponInfoPrice.couponId,"&siteId=").concat(this.siteId);this.$tool.uniNavigateTo({url:t})},confirm:function(){this.air=!1},next:function(t){if(1==this.current&&"pact"!=this.value)return this.air=!0,void(this.toView="productBox");this.current=this.current+1},sequence:function(){var t=this.couponList,n=t.length;if(!(n<=0)){for(var e=0;e<n;e++)for(var o=0;o<n-1-e;o++)if(1*t[o].reduce_price<1*t[o+1].reduce_price){var i=t[o+1];t[o+1]=t[o],t[o]=i}this.couponList=t;var u={fromPage:"select",siteId:this.siteId,userCouponId:t[0].user_coupon_id},r=u.fromPage;"select"===r&&u.siteId&&(this.siteId=u.siteId,this.couponInfoPrice.couponId=u.userCouponId,this.init())}},logged:function(){var t=this,n=this;this.$tool.uniRequest({url:"/api/order/buyNow",params:{goods_id:this.siteId,coupon_id:this.couponInfoPrice.couponId,goods_sku_id:"0"},success:function(e){console.log("res",e),e.exist_car?(n.detail=e.goods_list[0],n.couponList=e&&e.coupon_list?e.coupon_list:[],n.carCard=e.car?e.car:"",n.price=e.order_pay_price,n.couponInfoPrice.price=e.coupon_money,n.isLogin=!0,n.isShowAuthLogin=!1,0==e.coupon_money&&n.sequence()):n.$tool.uniRedirectTo({url:"/pages/base/add-car?siteId=".concat(t.siteId,"&pageForm=scan&status=add")})}})},pay:function(){var t=this,n={wxapp_id:"10001",goods_id:this.siteId,coupon_id:this.couponInfoPrice.couponId,pay_type:"20"};i.default.buyNow(n).then((function(n){var e=r(n,2),o=e[0],i=e[1];if(t.zhanId=i.success,"20"===o.pay_type){var u=o.payment;t.$tool.wxPayMoney(u.timeStamp,u.nonceStr,u.prepay_id,"MD5",u.paySign,(function(n){t.payGo(o,i)}))}else"30"===o.pay_type&&t.payGo(o,i)}))},payGo:function(n,e){var o=this;o.$tool.uniShowToast({title:"支付成功！"}),setTimeout((function(){0!=e.success?i.default.zhan({zhan_id:e.success,zhan_type:1}).then((function(t){o.loading=!0})):t.reLaunch({url:"/pages/scan/order-detail?id=".concat(n.order_id)})}),1e3)}}};n.default=p}).call(this,e("543d")["default"])},"79a0":function(t,n,e){"use strict";e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return u})),e.d(n,"a",(function(){return o}));var o={uButton:function(){return e.e("uview-ui/components/u-button/u-button").then(e.bind(null,"3e35"))}},i=function(){var t=this,n=t.$createElement;t._self._c},u=[]},"80b7":function(t,n,e){},8172:function(t,n,e){"use strict";(function(t){e("627e");o(e("66fd"));var n=o(e("6651"));function o(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])},8476:function(t,n,e){"use strict";var o=e("80b7"),i=e.n(o);i.a},"85b0":function(t,n,e){},"92af":function(t,n,e){"use strict";e.r(n);var o=e("79a0"),i=e("22d6");for(var u in i)"default"!==u&&function(t){e.d(n,t,(function(){return i[t]}))}(u);e("986a");var r,c=e("f0c5"),a=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"196f7d5e",null,!1,o["a"],r);n["default"]=a.exports},"986a":function(t,n,e){"use strict";var o=e("85b0"),i=e.n(o);i.a},c21c:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=i(e("b946"));function i(t){return t&&t.__esModule?t:{default:t}}var u={props:{zhan:{type:Number,default:0}},data:function(){return{type:1,load:!1,customStyle:{borderRadius:"50%",width:"150px",height:"150px",fontSize:"30px",textAlign:"center"},disabled:!1}},computed:{showStatus:function(){var t={1:"正在洗车",2:"已暂停",3:"正在复位"};return t[this.type]},buttonText:function(){var t={1:"紧急停止",2:"已停止",3:"正在复位"};return t[this.type]}},methods:{stop:function(){var t=this,n=this,e=2;this.load=!0,o.default.zhan({zhan_id:n.zhan,zhan_type:e}).then((function(o){n.load=!1,t.disabled=!0,n.type=e}))}}};n.default=u}},[["8172","common/runtime","common/vendor"]]]);