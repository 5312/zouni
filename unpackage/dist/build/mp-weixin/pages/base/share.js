(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/base/share"],{"2dd4":function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=i(e("a34a"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t,n,e,o,i,a,u){try{var c=t[a](u),r=c.value}catch(s){return void e(s)}c.done?n(r):Promise.resolve(r).then(o,i)}function u(t){return function(){var n=this,e=arguments;return new Promise((function(o,i){var u=t.apply(n,e);function c(t){a(u,o,i,c,r,"next",t)}function r(t){a(u,o,i,c,r,"throw",t)}c(void 0)}))}}var c={data:function(){return{width:null,height:null,bg:null,qr:null,bgPath:null,qrPath:null,num:null,imgUrl:null}},onLoad:function(){var n=this;t.getSystemInfo({success:function(t){n.width=t.screenWidth,n.height=t.windowHeight,n.num=t.pixelRatio}}),this.init().catch((function(t){console.log("init()",t)}))},methods:{init:function(){var t=this;return u(o.default.mark((function n(){var e,i,a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e=t,i=t.$tool.uniGetStorage("userId"),n.next=4,new Promise((function(t,n){e.$tool.uniRequest({url:"api/Codeok/",params:{uid:i,tid:"10014"},success:function(n){t(n)}})}));case 4:a=n.sent,t.qr=a.sharimg,t.bg=a.bjimg,t.downFilePath().catch((function(t){console.log("downFilePath()",t)}));case 8:case"end":return n.stop()}}),n)})))()},downFilePath:function(){var n=this;return u(o.default.mark((function e(){var i;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=n,n.$tool.uniShowLoading({title:"加载中"}),e.next=4,new Promise((function(n,e){t.downloadFile({url:i.qr,success:function(t){i.qrPath=t.tempFilePath,n(t)},fail:function(t){e(t),console.log(t,"downqr")}})}));case 4:return e.sent,e.next=7,new Promise((function(n,e){t.downloadFile({url:i.bg,success:function(t){i.bgPath=t.tempFilePath,n(t)},fail:function(t){e(t),console.log(t,"getbg")}})}));case 7:e.sent,n.getImgInfo().catch((function(t){console.log("getImgInfo",t)}));case 9:case"end":return e.stop()}}),e)})))()},getImgInfo:function(){var n=this;return u(o.default.mark((function e(){var i,a,u;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=n,e.next=3,new Promise((function(n,e){t.getImageInfo({src:i.qrPath,success:function(t){n(t)},fail:function(t){e(t)}})}));case 3:return a=e.sent,console.log(i.bgPath),e.next=7,new Promise((function(n,e){t.getImageInfo({src:i.bgPath,success:function(t){n(t)}})}));case 7:u=e.sent,n.create(u,a).catch((function(t){console.log("create",t)}));case 9:case"end":return e.stop()}}),e)})))()},create:function(n,e){var i=this;return u(o.default.mark((function a(){var u,c,r,s;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:u=i,c=t.createCanvasContext("shareImg"),r=i.width/2-e.width/2,s=i.height/2-e.height,console.log(r,s),c.drawImage(n.path,0,0,u.width,u.height),c.drawImage(e.path,r,s,100,100),c.draw(),setTimeout((function(){console.log("--createLoading"),u.$tool.uniHideLoading(),t.canvasToTempFilePath({canvasId:"shareImg",width:u.width,height:u.height,destWidth:u.width*u.num,destHeight:u.height*u.num,success:function(t){u.imgUrl=t.tempFilePath},fail:function(t){console.log(t)}})}),1e3);case 9:case"end":return o.stop()}}),a)})))()},saveImg:function(){}}};n.default=c}).call(this,e("543d")["default"])},8129:function(t,n,e){"use strict";e.r(n);var o=e("c1f4"),i=e("9de2");for(var a in i)"default"!==a&&function(t){e.d(n,t,(function(){return i[t]}))}(a);e("c0d6");var u,c=e("f0c5"),r=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"0b30a38e",null,!1,o["a"],u);n["default"]=r.exports},"9de2":function(t,n,e){"use strict";e.r(n);var o=e("2dd4"),i=e.n(o);for(var a in o)"default"!==a&&function(t){e.d(n,t,(function(){return o[t]}))}(a);n["default"]=i.a},a457:function(t,n,e){},c0d6:function(t,n,e){"use strict";var o=e("a457"),i=e.n(o);i.a},c1f4:function(t,n,e){"use strict";var o;e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return a})),e.d(n,"a",(function(){return o}));var i=function(){var t=this,n=t.$createElement;t._self._c},a=[]},eff6:function(t,n,e){"use strict";(function(t){e("627e");o(e("66fd"));var n=o(e("8129"));function o(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])}},[["eff6","common/runtime","common/vendor"]]]);