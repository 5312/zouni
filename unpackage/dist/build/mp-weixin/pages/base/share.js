(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/base/share"],{"2dd4":function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=i(e("a34a"));function i(t){return t&&t.__esModule?t:{default:t}}function u(t,n,e,o,i,u,a){try{var r=t[u](a),c=r.value}catch(s){return void e(s)}r.done?n(c):Promise.resolve(c).then(o,i)}function a(t){return function(){var n=this,e=arguments;return new Promise((function(o,i){var a=t.apply(n,e);function r(t){u(a,o,i,r,c,"next",t)}function c(t){u(a,o,i,r,c,"throw",t)}r(void 0)}))}}var r={data:function(){return{width:null,height:null,bg:null,qr:null,bgPath:null,qrPath:null,num:null,imgUrl:null}},onLoad:function(){var n=this;t.getSystemInfo({success:function(t){n.width=t.screenWidth,n.height=t.windowHeight,n.num=t.pixelRatio}}),this.init().catch((function(t){console.log("init()",t)}))},methods:{init:function(){var t=this;return a(o.default.mark((function n(){var e,i,u;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e=t,i=t.$tool.uniGetStorage("userId"),n.next=4,new Promise((function(t,n){e.$tool.uniRequest({url:"api/Codeok/",params:{uid:i,tid:"10014"},success:function(n){t(n)}})}));case 4:u=n.sent,t.qr=u.sharimg,t.bg=u.bjimg,t.downFilePath().catch((function(t){console.log("downFilePath()",t)}));case 8:case"end":return n.stop()}}),n)})))()},downFilePath:function(){var n=this;return a(o.default.mark((function e(){var i;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=n,n.$tool.uniShowLoading({title:"加载中"}),e.next=4,new Promise((function(n,e){t.downloadFile({url:i.qr,success:function(t){i.qrPath=t.tempFilePath,n(t)},fail:function(t){e(t),console.log(t,"downqr")}})}));case 4:return e.sent,e.next=7,new Promise((function(n,e){t.downloadFile({url:i.bg,success:function(t){i.bgPath=t.tempFilePath,n(t)},fail:function(t){e(t),console.log(t,"getbg")}})}));case 7:e.sent,n.getImgInfo().catch((function(t){console.log("getImgInfo",t)}));case 9:case"end":return e.stop()}}),e)})))()},getImgInfo:function(){var n=this;return a(o.default.mark((function e(){var i,u,a;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=n,e.next=3,new Promise((function(n,e){t.getImageInfo({src:i.qrPath,success:function(t){n(t)},fail:function(t){e(t)}})}));case 3:return u=e.sent,console.log(i.bgPath),e.next=7,new Promise((function(n,e){t.getImageInfo({src:i.bgPath,success:function(t){n(t)}})}));case 7:a=e.sent,n.create(a,u).catch((function(t){console.log("create",t)}));case 9:case"end":return e.stop()}}),e)})))()},create:function(n,e){var i=this;return a(o.default.mark((function u(){var a,r,c,s;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:a=i,r=t.createCanvasContext("shareImg"),c=i.width/2-e.width/2,s=i.height/2-e.height,console.log(c,s),r.drawImage(n.path,0,0,a.width,a.height),r.drawImage(e.path,c,s,100,100),r.draw(),setTimeout((function(){console.log("--createLoading"),a.$tool.uniHideLoading(),t.canvasToTempFilePath({canvasId:"shareImg",width:a.width,height:a.height,destWidth:a.width*a.num,destHeight:a.height*a.num,success:function(t){a.imgUrl=t.tempFilePath},fail:function(t){console.log(t)}})}),1e3);case 9:case"end":return o.stop()}}),u)})))()},saveImg:function(){}}};n.default=r}).call(this,e("543d")["default"])},8129:function(t,n,e){"use strict";e.r(n);var o=e("ed73"),i=e("9de2");for(var u in i)"default"!==u&&function(t){e.d(n,t,(function(){return i[t]}))}(u);e("ce15");var a,r=e("f0c5"),c=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,"e964d430",null,!1,o["a"],a);n["default"]=c.exports},"9de2":function(t,n,e){"use strict";e.r(n);var o=e("2dd4"),i=e.n(o);for(var u in o)"default"!==u&&function(t){e.d(n,t,(function(){return o[t]}))}(u);n["default"]=i.a},ce15:function(t,n,e){"use strict";var o=e("df70"),i=e.n(o);i.a},df70:function(t,n,e){},ed73:function(t,n,e){"use strict";var o;e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return u})),e.d(n,"a",(function(){return o}));var i=function(){var t=this,n=t.$createElement;t._self._c},u=[]},eff6:function(t,n,e){"use strict";(function(t){e("627e");o(e("66fd"));var n=o(e("8129"));function o(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,e("543d")["createPage"])}},[["eff6","common/runtime","common/vendor"]]]);